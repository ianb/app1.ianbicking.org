<html>
  <head>
    <title>Visibility test</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>
    // Browser compatibility:
    var hidden, visibilityChange;
    if (typeof document.hidden !== "undefined") {
      hidden = "hidden";
      visibilityChange = "visibilitychange";
      visibilityState = "visibilityState";
    } else if (typeof document.mozHidden !== "undefined") {
      hidden = "mozHidden";
      visibilityChange = "mozvisibilitychange";
      visibilityState = "mozVisibilityState";
    } else if (typeof document.msHidden !== "undefined") {
      hidden = "msHidden";
      visibilityChange = "msvisibilitychange";
      visibilityState = "msVisibilityState";
    } else if (typeof document.webkitHidden !== "undefined") {
      hidden = "webkitHidden";
      visibilityChange = "webkitvisibilitychange";
      visibilityState = "webkitVisibilityState";
    }

    document.addEventListener(visibilityChange, function () {
      var isHidden = document[hidden];
      var state = document[visibilityState];
      var text = $('#output').text();
      text += '\n';
      text += visibilityChange + ' hidden: ' + isHidden + ' state: ' + state + ' at ' + (new Date());
      $('#output').text(text);
    }, false);
    </script>
  </head>
  <body>

    <pre id="output">Output:</pre>

<div>To test state changes, switch to or from this page; each even will be displayed in the box above.</div>

  </body>
</html>
